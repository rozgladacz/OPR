{% extends "base.html" %}
{% block title %}Armie - OPR{% endblock %}
{% block content %}
<div class="d-flex flex-wrap gap-2 gap-md-3 justify-content-between align-items-center mb-3">
  <h2>Armie</h2>
  <a class="btn btn-primary" href="/armies/new">Nowa armia</a>
</div>

<div class="row g-4">
  <div class="col-lg-6">
    <h4>Moje armie</h4>
    <div class="list-group">
      {% for army in mine %}
      <a class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" href="/armies/{{ army.id }}">
        <span>{{ army.name }}</span>
        <span class="badge bg-secondary">Jednostek: {{ army.units|length }}</span>
      </a>
      {% else %}
      <div class="list-group-item text-muted">Brak własnych armii</div>
      {% endfor %}
    </div>
  </div>
  <div class="col-lg-6">
    <h4>Globalne</h4>
    <div class="list-group">
      {% for army in global_items %}
      <a class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" href="/armies/{{ army.id }}">
        <span>{{ army.name }}</span>
        <span class="badge bg-secondary">Jednostek: {{ army.units|length }}</span>
      </a>
      {% else %}
      <div class="list-group-item text-muted">Brak globalnych armii</div>
      {% endfor %}
    </div>
  </div>
  {% if user and user.is_admin %}
  <div class="col-lg-12">
    <h4>Pozostałe armie użytkowników</h4>
    <div class="list-group">
      {% for army in others %}
      <div class="list-group-item d-flex justify-content-between align-items-center">
        <a class="text-decoration-none flex-grow-1 me-3 d-flex justify-content-between align-items-center" href="/armies/{{ army.id }}">
          <span>{{ army.name }}{% if army.owner %} – {{ army.owner.username }}{% endif %}</span>
          <span class="badge bg-secondary">Jednostek: {{ army.units|length }}</span>
        </a>
        <form method="post" action="/armies/{{ army.id }}/takeover" class="ms-2">
          <button class="btn btn-sm btn-outline-secondary" type="submit">Przejmij</button>
        </form>
      </div>
      {% else %}
      <div class="list-group-item text-muted">Brak armii innych użytkowników</div>
      {% endfor %}
    </div>
  </div>
  {% endif %}
</div>
{% endblock %}
